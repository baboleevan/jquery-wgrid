/**
jQuery Wgrid Plugin.
 @ author	: changwan jun
 @ mail		: me@wani.kr
 @ website	: http://wani.kr
**/
(function(e){var t={item_width:"auto"},n=e("<div>").css({"float":"left"}).addClass("bricks-column"),r=[];var i=function(){for(var e in r){r[e].resize()}};e(window).bind("resize",i);e.Wgrid=function(n,r){this.settings=e.extend(t,n);this.container=r;this.container_width=0;this.items=[];this.item_width=0;this.item_column=0;this.__construct()};e.Wgrid.prototype={__construct:function(){var t=e(this.container);var i=t.innerWidth();var s=this.items;t.find("> *").each(function(){s.push(this)});var o=0;if(this.settings.item_width=="auto"){var u=0;for(var a in s){u=Math.max(e(s[a]).outerWidth(true),u)}o=u}else{o=this.settings.item_width}var f=Math.max(1,parseInt(i/o));this.container_width=i;this.items=s;this.item_width=o;this.item_column=f;for(var l=0;l<f;l++){var c=n.clone().css({width:o});c[0].id="bricks-column-"+l;t.append(c)}r.push(this);this.fetch(0)},__restruct:function(t){var n=this.items.length;var r=this.items;if(t==null){e(this.container).find("> *:not( .bricks-column )").each(function(){r.push(this)})}else{e(t).each(function(){r.push(this)})}this.items=r;this.fetch(n)},resize:function(){var t=false;var r=e(this.container);var i=r.innerWidth();var s=this.items;var o=0;if(this.settings.item_width=="auto"){var u=0;for(var a in s){u=Math.max(e(s[a]).outerWidth(true),u)}o=u}else{o=this.settings.item_width}var f=Math.max(1,parseInt(i/o));if(this.container_width!=i){this.container_width=i;t=true}if(this.item_width!=o){this.item_width=o;t=true}var l=this.item_column;if(this.item_column!=f){this.item_column=f;t=true}if(t){if(f!==l){if(l>f){for(var c=f;c<l;c++){e("#bricks-column-"+c).hide()}}else{for(var c=l;c<f;c++){if(e("#bricks-column-"+c).length==0){var h=n.clone();h[0].id="bricks-column-"+c;r.append(h)}else{e("#bricks-column-"+c).show()}}}}if(f!=1){e("div.bricks-column").css({width:o})}else{e("div.bricks-column").css({width:"auto"})}this.fetch(0)}},fetch:function(t){var n=[];for(var r=0;r<this.item_column;r++){n[r]=0;if(t>0){e("#bricks-column-"+r).find("> *").each(function(){n[r]+=e(this).outerHeight(true)})}}for(var r=t;r<this.items.length;r++){var i=n.indexOf(Math.min.apply(Math,n));e("#bricks-column-"+i).append(this.items[r]);n[i]+=e(this.items[r]).outerHeight(true)}}};e.fn.wgrid=function(t,n){this.each(function(){var r=e.data(this,"bricks");if(typeof r=="undefined"){r=new e.Wgrid(t,this);e.data(this,"bricks",r)}else{if(t=="append"){r.__restruct(n)}else{r.__restruct(null)}}});return this}})(jQuery)